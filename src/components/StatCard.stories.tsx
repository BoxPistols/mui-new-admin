import type { Meta, StoryObj } from '@storybook/react'
import StatCard from './StatCard'

const meta: Meta<typeof StatCard> = {
  title: 'Components/Data Display/StatCard',
  component: StatCard,
  parameters: {
    layout: 'centered',
    docs: {
      description: {
        component: `
# StatCard（統計カードコンポーネント）

重要な指標データを視覚的に表示するカードコンポーネントです。数値、トレンド、スパークラインチャートを組み合わせて情報を効果的に伝達します。

## 設計思想

### データビジュアライゼーション
- **一目で理解**: 重要な数値を大きく、明確に表示
- **トレンド表示**: 色とアイコンによる直感的な変化の表現
- **コンテキスト提供**: 期間情報による数値の意味づけ

### 視覚的ヒエラルキー
- **主要数値**: 最も大きく、コントラストの高い表示
- **トレンド指標**: 色付きチップによる目立つ変化表示
- **補助情報**: 控えめな色での期間表示
- **詳細データ**: スパークラインによる推移の可視化

## 主な機能

### トレンド表示
- **上昇（up）**: 緑色での成功・成長を表現
- **下降（down）**: 赤色での注意・減少を表現  
- **中立（neutral）**: グレーでの安定・変化なしを表現

### スパークラインチャート
- **ミニチャート**: カード内に収まるコンパクトな時系列表示
- **エリアチャート**: グラデーション効果による美しい可視化
- **インタラクティブ**: ホバー時のツールチップ表示
- **ハイライト**: データポイントの強調表示

## レスポンシブデザイン

### カードレイアウト
- **フレキシブル高さ**: コンテンツに応じた自動調整
- **アウトライン**: 軽量で洗練された境界線
- **適応的スペーシング**: 画面サイズに応じた内側余白

### チャートサイズ
- **固定高さ**: 50pxの一定高さでレイアウト安定性を確保
- **フルワイド**: カード幅いっぱいでのチャート表示
- **レスポンシブデータ**: デバイスに応じたデータポイント調整

## 技術的特徴

### Material-UI Charts統合
- **SparkLineChart**: MUI X Chartsのミニチャート機能
- **カスタムグラデーション**: 各カード固有のエリアグラデーション
- **テーマ統合**: ライト/ダークテーマでの自動色調整

### パフォーマンス
- **軽量レンダリング**: 最小限のDOMによる高速描画
- **効率的更新**: データ変更時の部分再描画
- **メモリ最適化**: 不要なオブジェクト生成の回避

## 使用場面

### ダッシュボード
- **KPI表示**: 重要業績指標の一覧表示
- **リアルタイム監視**: システムメトリクスの継続監視
- **業績追跡**: 売上、ユーザー数等のビジネス指標

### 分析レポート
- **比較分析**: 複数指標の並列比較
- **トレンド分析**: 時系列での変化パターン把握
- **異常検知**: 通常パターンからの逸脱確認

### 運用監視
- **システム状態**: CPU、メモリ等のリソース監視
- **ユーザー活動**: アクセス数、セッション数の追跡
- **ビジネス指標**: コンバージョン、エンゲージメント測定

## アクセシビリティ

### セマンティック構造
- **見出し要素**: h2による適切な情報階層
- **説明的ラベル**: データの意味を明確に表現
- **構造化表示**: 論理的な要素配置

### 視覚的配慮
- **高コントラスト**: 十分な色の差による視認性確保
- **カラーブラインド対応**: 色以外での情報伝達（数値、形状）
- **拡大対応**: テキストサイズ変更時の適切なレイアウト維持

### インタラクティブ要素
- **フォーカス表示**: キーボードナビゲーション時の明確な表示
- **スクリーンリーダー**: チャート情報の代替テキスト提供
- **操作説明**: ツールチップでの詳細情報提供
        `
      }
    }
  },
  tags: ['autodocs'],
  argTypes: {
    title: {
      control: 'text',
      description: '統計カードのタイトル（指標名）'
    },
    value: {
      control: 'text',
      description: '表示する主要な数値'
    },
    interval: {
      control: 'text',
      description: 'データの期間や範囲を示すテキスト'
    },
    trend: {
      control: 'select',
      options: ['up', 'down', 'neutral'],
      description: 'トレンドの方向性（上昇/下降/中立）'
    },
    data: {
      control: 'object',
      description: 'スパークラインチャート用の数値配列'
    },
  },
}

export default meta
type Story = StoryObj<typeof meta>

export const Default: Story = {
  args: {
    title: 'Users',
    value: '14k',
    interval: 'Last 30 days',
    trend: 'up',
    data: [
      200, 24, 220, 260, 240, 380, 100, 240, 280, 240, 300, 340, 320, 360, 340,
      380, 360, 400, 380, 420, 400, 640, 340, 460, 440, 480, 460, 600, 880, 920,
    ],
  },
  parameters: {
    docs: {
      description: {
        story: '標準的な上昇トレンドの統計カード。ユーザー数の増加を緑色のチップとスパークラインで表現します。'
      }
    }
  }
}

export const TrendDown: Story = {
  args: {
    title: 'Conversions',
    value: '325',
    interval: 'Last 30 days',
    trend: 'down',
    data: [
      1640, 1250, 970, 1130, 1050, 900, 720, 1080, 900, 450, 920, 820, 840, 600,
      820, 780, 800, 760, 380, 740, 660, 620, 840, 500, 520, 480, 400, 360, 300,
      220,
    ],
  },
  parameters: {
    docs: {
      description: {
        story: '下降トレンドの統計カード。コンバージョン数の減少を赤色のチップとスパークラインで表現します。'
      }
    }
  }
}

export const TrendNeutral: Story = {
  args: {
    title: 'Event count',
    value: '200k',
    interval: 'Last 30 days',
    trend: 'neutral',
    data: [
      500, 400, 510, 530, 520, 600, 530, 520, 510, 730, 520, 510, 530, 620, 510,
      530, 520, 410, 530, 520, 610, 530, 520, 610, 530, 420, 510, 430, 520, 510,
    ],
  },
  parameters: {
    docs: {
      description: {
        story: '中立トレンドの統計カード。イベント数の安定を灰色のチップとスパークラインで表現します。'
      }
    }
  }
}

export const LargeNumbers: Story = {
  args: {
    title: 'Revenue',
    value: '$2.4M',
    interval: 'This quarter',
    trend: 'up',
    data: [
      50000, 52000, 48000, 55000, 60000, 58000, 62000, 65000, 63000, 70000, 75000, 80000,
      78000, 85000, 90000, 88000, 95000, 100000, 105000, 110000, 115000, 120000, 125000, 130000,
      135000, 140000, 145000, 150000, 155000, 160000,
    ],
  },
  parameters: {
    docs: {
      description: {
        story: '大きな数値の表示例。収益データで百万単位の数値を適切にフォーマットして表示します。'
      }
    }
  }
}